<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/simplemde/latest/simplemde.min.css">
    <link rel="stylesheet" href="./assets/css/style.css">
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
    <title>Blog</title>
</head>

<body>
    <div id="app">
        <main class="mw">
            <router-view></router-view>
        </main>

        <footer class="footer">
            <p>&copy; <a href="https://lezzin.github.io" target="_blank">Lezzin</a> & Wellyngton Souza</p>
        </footer>
    </div>

    <template id="home-template">
        <div>
            <div class="presentation">
                <h2 class="presentation__title">Olá, sou Wellyngton Souza</h2>
                <p class="presentation__description">
                    Lorem ipsum dolor, sit amet consectetur adipisicing elit. Sapiente, fugiat omnis fugit enim velit
                    rem
                    natus nesciunt, quasi corporis quidem, quos maxime ex repudiandae itaque eaque. Sequi beatae, modi
                    omnis facilis optio harum alias unde dolor, quisquam veniam sed, magni eos praesentium reprehenderit
                    dolore quasi assumenda at sit natus minus.
                </p>
            </div>
            <nav class="preview" v-if="posts.length > 0">
                <router-link v-for="post in posts" class="post" :to="'post/' + post.id">
                    <h2 class="post__title">{{ post.title }}</h2>
                    <p class="post__description">{{ post.description }}</p>
                </router-link>
            </nav>
            <p v-else>Nenhuma postagem encontrada.</p>
        </div>
    </template>

    <template id="post-template">
        <div>
            <a href="javascript:history.back()" class="btn btn--back"><i class="bi bi-arrow-left"></i> Voltar</a>

            <textarea id="content" style="display: none;"></textarea>

            <section class="view">
                <h2 class="view__title">{{ post.title }}</h2>
                <div class="view__content" v-html="renderMarkdown(post.content)"></div>

                <div class="view__footer">
                    <a class="btn btn--success" @click="share" @v-if="navigator.share !== undefined"
                        href="javascript:void(0)" title="Compartilhar postagem">
                        <i class="bi bi-share"></i> Compartilhar
                    </a>
                </div>
            </section>
        </div>
    </template>

    <template id="admin-template">
        <div class="admin">
            <header class="admin__header">
                <h2 class="admin__title">Postagens</h2>

                <button type="button" class="btn btn--success" title="Adicionar nova postagem" @click="openAddModal">
                    <i class="bi bi-plus"></i> Nova postagem
                </button>
            </header>

            <div class="preview" v-if="posts.length > 0">
                <section v-for="post in posts" :key="post.id" class="post">
                    <h2 class="post__title">{{ post.title }}</h2>
                    <p class="post__description">{{ post.description }}</p>

                    <div class="post__buttons">
                        <router-link :to="'post/' + post.id" class="btn btn--success" role="button">
                            <i class="bi bi-eye"></i> Visualizar
                        </router-link>
                        <button type="button" class="btn btn--out-success" title="Editar postagem"
                            @click="openEditModal(post)">
                            <i class="bi bi-pencil"></i> Editar
                        </button>
                        <button type="button" class="btn btn--danger" title="Excluir postagem"
                            @click="deletePost(post.id)">
                            <i class="bi bi-trash"></i> Excluir
                        </button>
                    </div>
                </section>
            </div>
            <p v-else>Nenhuma postagem encontrada.</p>

            <aside :class="['modal', modalAddOpened && 'active']">
                <div class="modal__dialog">
                    <div class="modal__header">
                        <h3 class="modal__title">Adicionar nova postagem</h3>
                        <button type="button" class="btn modal__close" title="Fechar modal" @click="closeAddModal">
                            <i class="bi bi-x"></i>
                        </button>
                    </div>

                    <div class="modal__body">
                        <form class="form" @submit.prevent="addPost">
                            <div class="form__group">
                                <label for="title">Título</label>
                                <input type="text" v-model="addingPost.title" placeholder="Título da postagem" required>
                                <span class="form__helper" v-if="addFormMessages.title">
                                    {{ addFormMessages.title }}
                                </span>
                            </div>

                            <div class="form__group">
                                <label for="description">Descrição</label>
                                <input type="text" v-model="addingPost.description" placeholder="Descrição da postagem"
                                    required>
                                <span class="form__helper" v-if="addFormMessages.description">
                                    {{ addFormMessages.description }}
                                </span>
                            </div>

                            <div class="form__group">
                                <label for="content">Conteúdo (Markdown permitido)</label>
                                <textarea id="add-content" v-model="addingPost.content"
                                    placeholder="Conteúdo da postagem"></textarea>
                            </div>

                            <button type="submit" class="btn btn--success">Adicionar</button>
                        </form>
                    </div>
                </div>
            </aside>

            <aside :class="['modal', modalEditOpened && 'active']">
                <div class="modal__dialog">
                    <div class="modal__header">
                        <h3 class="modal__title">Editar postagem</h3>
                        <button type="button" class="btn modal__close" title="Fechar modal" @click="closeEditModal">
                            <i class="bi bi-x"></i>
                        </button>
                    </div>

                    <div class="modal__body">
                        <form class="form" @submit.prevent="editPost">
                            <div class="form__group">
                                <label for="title">Título</label>
                                <input type="text" v-model="editingPost.title" placeholder="Título da postagem"
                                    required>
                            </div>

                            <div class="form__group">
                                <label for="description">Descrição</label>
                                <input type="text" v-model="editingPost.description" placeholder="Descrição da postagem"
                                    required>
                            </div>

                            <div class="form__group">
                                <label for="content">Conteúdo (Markdown permitido)</label>
                                <textarea id="edit-content" v-model="editingPost.content"
                                    placeholder="Conteúdo da postagem"></textarea>
                            </div>

                            <button type="submit" class="btn btn--success">Editar</button>
                        </form>
                    </div>
                </div>
            </aside>
        </div>
    </template>

    <script src="https://cdn.jsdelivr.net/npm/vue@2"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue-router@3"></script>
    <script type="module" src="./assets/js/App.js"></script>
</body>

</html>